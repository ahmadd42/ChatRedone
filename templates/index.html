<!DOCTYPE html>
<html lang="en">
	<head>
		    
		<title>Chatter Box - A place to socialize</title>
		    
		<link
			href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
			rel="stylesheet"
			integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
			crossorigin="anonymous"
		/>
    <link href="../static/css/MainDesign.css" rel="stylesheet" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
    
      </head>

	<body>
		
        <div class="divide left">
            
                <form class="FrmSignin" method="post" id="frmlogin">
                <div class="imgcontainer">
                  <img src="../static/img/img_avatar2.jpg" alt="Avatar" class="avatar">
                </div>
              
                <div class="container">
                  <p id="lgstatus" class="lstatus"></p>

                  <table width="100%">
                  
                  <tr><td><label for="uname"><b>Username</b></label></td></tr>
                  <tr><td><input class="inputfield Signin" type="text" placeholder="Enter Username" name="uname" id="uname" value="" autocomplete="off" required></td></tr>
              
                  <tr><td><label for="psw"><b>Password</b></label></td></tr>
                  <tr><td><input class="inputfield Signin" type="password" placeholder="Enter Password" name="psw" id="psw" value="" autocomplete="off" required></td></tr>
              
                  <tr><td><input type="button" class="BtnSignin" value="submit" tabindex="0" onclick="submitForm()"></td></tr>
                  <tr><td><label>
                    <input type="checkbox" checked="checked" name="remember"> Remember me
                  </label></td></tr>
                  </table>
                </div>
              
                <div class="container">
                  
                  <span class="psw"><a href="#">Forgot password ?</a></span>
                </div>
              </form>
              <script>
                function submitForm() {
                    var formElement = document.getElementById('frmlogin');
                    var data = new FormData(formElement);
                    fetch('/login/', {
                          method: 'POST',
                          headers: {
                            'Accept': 'application/json',
                            'Content-Type': 'application/json'
                        },
                          body: JSON.stringify(Object.fromEntries(data))
                        })
                        .then(resp => resp.text())  // or, resp.json(), etc.
                        .then(data => {
                          
                          if(data == "{\"msg\":\"Logged in successfully\"}") {
                            window.location.replace("/dashboard/")
                          }
                          else {
                          var arr = data.split(/[{}:]+/);
                          document.getElementById("lgstatus").innerHTML = arr[2];
                          }
                        })
                        .catch(error => {
                          console.error(error);
                        });
                }
             </script>


              <br>
            
              <div class="container"> 
              <p class="label1">New to Chatter Box ?</p>  
              <a class="label signup" href="signup.html">Sign up today</a>
              <!--<a class="label signup" href="#" onClick="window.open('/signup/','pagename','resizable, height=800,width=600'); return false;">Sign up today</a>-->

            </div>

            <!--<ul class="nav nav-pills">
				<li class="nav-item">
					<a href="/" class="nav-link active" aria-current="page">Home</a>
				</li>
                
                <li class="nav-item">
					<a href="/" class="nav-link" aria-current="page">Sign in to chat room</a>
				</li>

                <li class="nav-item">
							<a href="/" class="nav-link">New to chatter box</a>
				</li>
			</ul>-->
		</div>			                        

        <div class="split right">		            
            <div class="centered">
            <span class="fs-4"><h1>ChAtter BoX</h1></span>
            </div>
        </div>			


    </body>
</html>